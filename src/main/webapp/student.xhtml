<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:of="http://omnifaces.org/functions"
                xmlns:sec="http://www.springframework.org/security"
                xmlns:pe="http://primefaces.org/ui/extensions"
                template="/WEB-INF/template.xhtml">
  
<ui:define name="subheader">
	<h:outputLink value="#{request.contextPath}/student" styleClass="BoldGray">
		<h:outputText value="student"/> 
	</h:outputLink>    
</ui:define>
    
<ui:define name="content">

<f:loadBundle id="bundle" var="bundle" basename="#{studentController.currentBundle}"/>



<h:form id="studentForm">

<sec:ifAnyGranted roles="ROLE_ADMIN">
	<p:defaultCommand target="createStudent" />
</sec:ifAnyGranted>

<h:panelGroup id="studentListPanel" layout="block" styleClass="Container100 ui-fluid">
	<div class="ContainerIndent">
		<div class="Card ShadowEffect">
		
			<h2 class="BigTopic">					
				<h:outputText value="ՈԻսանողներ"/>
			</h2>
						     									    
			
			<p:dataTable value="#{studentController.students}" var="student">													
				
				
				<p:column headerText="ՀՀ" >
					<h:outputText value="#{student.id}" />
				</p:column>
				
				<p:column headerText="#{bundle['contractFirstName']}">
					<h:outputText value="#{student.firstName}" />
				</p:column>	
				
				<p:column headerText="#{bundle['contractLastName']}">		
					<h:outputText value="#{student.lastName}" />
				</p:column>	
				
				<p:column headerText="#{bundle['contractMiddleName']}">
					<h:outputText value="#{student.middleName}" />
				</p:column>	
				
				<p:column headerText="Էլ․ հասցե">
					<h:outputText value="#{student.email}" />
				</p:column>				
				
				<p:column headerText="Ծննդյան տարեթիվը">
					<h:outputText value="#{student.dateOfBirth}" />
				</p:column>		
				
				<p:column headerText="#{bundle['group']}">
					<h:outputText value="#{student.groupName}" />
				</p:column>	
				
				
				
				<sec:ifAnyGranted roles="ROLE_ADMIN">
					<p:column style="text-align: center; white-space: nowrap;" exportable="false">
						<f:facet name="header">
			                <h:outputText value="#{bundle['studentActions']}"/>
			            </f:facet>
			            			            			            
			            <p:commandButton actionListener="#{studentController.onEditStudent(student)}"
			           					 update="studentForm:studentCreatePanel"
			       						 process="@this"		                   			 		                       		 
				                   		 title="Փոփոխել ուսանողի տվյալները"		        
				                   		 icon="fa fa-pencil Fs16 White"
				                   		 style="width:auto"			                       		 
				                   		 styleClass="GreenButton"/>
				                   		 
				            		 
					              				        			        			        
			        	<p:commandButton actionListener="#{studentController.onRemoveStudent(student)}"
			        					 process="@this"
	              						 update="studentForm:studentListPanel, studentForm:studentCreatePanel"
			                   			 icon="fa fa-trash-o"
			                       		 title="Ջնջել ուսանողին"
			                       		 styleClass="RedButton"
			                       		 onclick="if (!confirm('Դուք վստա՞հ եք, որ ուզում եք ջնջել ընտրված ուսանողին։')) return false;"/>		        	
	       			</p:column>
       			</sec:ifAnyGranted>
       			
			</p:dataTable>						
						
		</div>
	</div>
</h:panelGroup>






<h:panelGroup id="studentCreatePanel" layout="block" styleClass="Container100 ui-fluid">
	<div class="ContainerIndent">
		<div class="Card ShadowEffect">						
		
			<p:messages id="infoErrorMessages" showDetail="true" autoUpdate="false" closable="true" globalOnly="true"/>
			
			<h2 class="BigTopic">					
				<h:outputText value="ՈԻսանողի տվյալներ"/>&#160;					                 
			</h2>
			
			<div class="EmptyBox20"></div>
			<p:panelGrid id="studentPanel" columns="3" columnClasses="ui-grid-col-2,ui-grid-col-5,i-grid-col-5" layout="grid" styleClass="ui-panelgrid-blank" style="border:0px none; background-color:transparent;" >
             		
				     		
             	<p:outputLabel for="firstName" value="#{bundle['contractFirstName']} *"/>
               		<p:inputText id="firstName" value="#{studentController.studentBean.firstName}" maxlength="50" tabindex="1"/>
               	<p:message for="firstName" /> 	
            	
               	<p:outputLabel for="lastName" value="#{bundle['contractLastName']} *"/>
               		<p:inputText id="lastName" value="#{studentController.studentBean.lastName}" maxlength="50" tabindex="2"/>
               	<p:message for="lastName" />
               	   	
               	<p:outputLabel for="middleName" value="#{bundle['contractMiddleName']} *"/>
               		<p:inputText id="middleName" value="#{studentController.studentBean.middleName}" maxlength="50" tabindex="3"/>
               	<p:message for="middleName" />
               	
               	<p:outputLabel for="email" value="Էլ․ հասցե *"/>               	
               		<p:inputText id="email" value="#{studentController.studentBean.email}" tabindex="4"/>
               	<p:message for="email" />
               	
               	<p:outputLabel for="dateOfBirth" value="Ծննդյան տարեթիվը *"/>               	
               	<p:calendar id="dateOfBirth" value="#{studentController.studentBean.dateOfBirth}" tabindex="5"/>
               	<p:message for="dateOfBirth" />
               	
               	<p:outputLabel for="group" value="#{bundle['group']} *" />
       			 <p:selectOneMenu id="group" value="#{studentController.studentBean.selectedGroupId}" style="width:125px">
  
 									<f:selectItem itemLabel="-------" />
									<f:selectItems value="#{studentController.studentBean.groups}"/>
	
       			 </p:selectOneMenu>
				<p:message for="group" />
               	        
     		</p:panelGrid>
         	
         	<sec:ifAnyGranted roles="ROLE_ADMIN">
      		<div class="EmptyBox20"></div>
         		
      		<h:panelGroup id="buttonsPanel" layout="block">      			      			
          		<p:commandButton id="createStudent" actionListener="#{studentController.onCreateStudent}" 
          					     update="studentForm:studentCreatePanel, studentForm:studentListPanel"
                    			 value="#{studentController.studentBean.id != null ? 'Թարմացնել' : 'Ավելացնել'}" 
                    			 styleClass="#{studentController.studentBean.id != null ? 'GreenButton' : ''}"                     				 
                    			 style="width:auto" icon="#{studentController.studentBean.id != null ? 'fa fa-pencil' : 'fa fa-plus'} Fs16 White"
                    			 rendered="#{studentController.studentBean.id == null}"/>
                    			 
                    			 
                 <p:commandButton id="updateTournamnet" actionListener="#{studentController.onUpdateStudent}" 
          					     update="studentForm:studentCreatePanel, studentForm:studentListPanel"
                    			 value="#{bundle['updateTournament']}" 
                    			 styleClass="GreenButton"                     				 
                    			 style="width:auto" 
                    			 icon="fa fa-pencil Fs16 White"
                    			 rendered="#{studentController.studentBean.id != null}"/>
               	                    				 
              	<p:commandButton actionListener="#{studentController.onCancel}" 
              				     update="studentCreatePanel"
              					 process="@this"
                				 value="#{bundle['denied']}" 
                				 styleClass="RedButton"                     				 
                				 style="width:auto" icon="fa fa-ban Fs16 White"
                				 rendered="#{studentController.studentBean.id != null}"/>
                    				 
              	
			</h:panelGroup>
			</sec:ifAnyGranted>						
						
		</div>
	</div>
</h:panelGroup>


</h:form>

        
</ui:define>

</ui:composition>